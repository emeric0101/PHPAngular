# PHPAngular

## The simpliest way to angularise the world !


### Installation
#### Composer config
Define all namespace we will use for Entity in composer.json (you can use the namespace you want but it must be like XX\XX\Entity, and other class you may need like Controller, Service, ...)

`
    "psr-4": {
        "Emeric0101\\PHPAngular\\Entity\\": "src/Entity/"
    }
`


Use composer with `composer require phpangular`

#### boostrap.php
You need to setup the mysql and the namespace login settings in **yourapp/bootstrap.php**
Set your *targetEntity*, this is the name of your bundle, every Entities must be in this namespace but with "Entity" after
For example, the vendor name is Emeric, the bundle name is test, the entity is Post, you should have Emeric\test\Entity\Post

#### Doctrine
Now you have to create the Entity with doctrine [Create Entities](http://symfony.com/doc/current/doctrine.html#creating-an-entity-class) ** You must use Annotation**

Every entity have to derived from **Emeric0101\PHPAngular\Entity\EntityAbstract**

You can use all association with doctrine you want !

Then you can use doctrine to create the mysql database with `doctrine orm:schema-tool:create`

#### PHPAngularisation !

Run the script

`phpangular`

`cd web

bower install
`

Then `tsc` (you will get some error but don't worry, the system works and i'm working to fix this)

### Usage
The script has created a **web** folder. This folder contains all public data accessible from web (Typescript, html, ...).
In the folder **src**, all php source files have been generated by the script.

In fact, most of the code are in the **web/js** and in the **web/template** folders. In the src folder, you will just need to set all post operation (**with right check !!!**)

#### PHP Controller
For instance, we admit that you have created a Entity called **TestVendor\TestBundle\Message** which have a *title*(string) and a *description*(string).
So we will need a controller in the server side to save the entity, of get some entity with parameters.

> Some controller function has been already implemented : findAll and findById so you don't need to implemented them.

Create a folder src/Controller then create a file Message.php
```PHP
<?php
namespace TestVendor\TestBundle\Controller;
use Emeric0101\PHPAngular\Controller\Entity;
use Emeric0101\PHPAngular\Service\DbService;
use TestVendor\TestBundle\Entity\Message as EntityMessage;
class Message extends Entity {

    public function post($id = 0) {
        $entityMessage = $this->entityManager->find("TestVendor\TestBundle\Entity\Message", $id);
        if ($entityMessage === NULL) {
            $entityMessage = new EntityMessage();
        }
        // Get from POST
        $title = $this->request->postFromArray("Message",'title', ''));
        $desription = $this->request->postFromArray("Message",'description', ''));
        
        $entityMessage->setTitle($title);
        $entityMessage->setDescription($description);
        $this->entityManager->persist($entityMessage);
        $this->entityManager->flush();
        $this->response->setResponse("Message", $entityMessage);
        return true;
    }
}

```
